{{- $img := resources.Get .Destination -}}

{{- with $img -}}
<script>
    console.log({{$img.Width}})
    console.log({{$img.Height}})
</script>
{{- if gt $img.Width 900 -}}
    {{- $img = $img.Resize ("900x q90") -}}
{{- else -}}
    {{- $img = $img.Resize (printf "%dx%d q75" $img.Width $img.Height) -}}
    <script>
        console.log({{$img.Width}})
        console.log({{$img.Height}})
    </script>
{{- end -}}

<figure class="image-caption">
    <img alt="{{ $.Text }}" src="{{ $img.RelPermalink }}" loading="lazy" class="image-figure"
    height="{{- $img.Height -}}" width="{{- $img.Width -}}"
    style="aspect-ratio: {{- div (add $img.Width .1) $img.Height -}};width: 100%;height: auto;"/>
    <figcaption>{{ with $.Title | safeHTML }}{{ . }}{{ end }}</figcaption>
</figure>

{{- else -}}
<p class="md__image">
    <img src="{{ .Destination | safeURL }}" alt="{{ .Text }}" {{ with .Title }} title="{{ . }}"{{ end }} />
</p>
{{- end -}}

